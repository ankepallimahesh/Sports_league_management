{% extends 'base.html' %}
{% block content %}
<style>
  .players-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;margin-top:12px}
  .player-card{background:#fff;padding:12px;border-radius:12px;box-shadow:0 10px 28px rgba(12,24,50,0.06)}
  .muted{color:var(--muted)}
</style>

<div class="container">
  <header style="display:flex;justify-content:space-between;align-items:center">
    <h3 style="margin:0">Players</h3>
    {% if request.user.is_authenticated %}
      <a class="btn" href="{% url 'accounts:edit_player' %}">Edit Profile</a>
    {% endif %}
  </header>

  <section class="players-grid">
    {% for p in players %}
      <article class="player-card">
        <div style="display:flex;align-items:center;gap:12px">
          {% if p.photo %}
            <img src="{{ p.photo.url }}" alt="{{ p.full_name }}" style="width:56px;height:56px;border-radius:10px;object-fit:cover">
          {% else %}
            <div style="width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700">{{ p.full_name|slice:":1" }}</div>
          {% endif %}
          <div>
            <div style="font-weight:800"> <a href="{% url 'accounts:player_profile' p.pk %}">{{ p.full_name }}</a></div>
            <div class="muted" style="font-size:13px">{{ p.position|default:"" }}</div>
            <div class="muted" style="font-size:13px;margin-top:6px">
              <strong style="font-weight:600">Teams:</strong>
              <span>
                {% for team in p.teams.all %}
                  {{ team.name }}{% if not forloop.last %}, {% endif %}
                {% empty %}
                  â€” none
                {% endfor %}
              </span>
            </div>
          </div>
        </div>
        {% if p.recent_matches %}
          <div style="margin-top:12px;border-top:1px dashed #eef2f6;padding-top:12px">
            <div style="font-size:13px;margin-bottom:6px;font-weight:700">Recent matches</div>
            <ul style="margin:0;padding-left:16px">
              {% for item in p.recent_matches %}
                <li style="margin-bottom:6px;font-size:13px">
                  {% if item.team %}
                    <strong>{{ item.team.name }}</strong>
                    vs <em>{{ item.opponent.name }}</em>
                  {% else %}
                    {{ item.match.home.name }} vs {{ item.match.away.name }}
                  {% endif %}
                  <div class="muted" style="font-size:12px">{{ item.match.date|date:"M d, Y H:i" }}</div>
                </li>
              {% endfor %}
            </ul>
          </div>
        {% endif %}
      </article>
    {% empty %}
      <div class="player-card">No players yet.</div>
    {% endfor %}
  </section>
</div>

{% endblock %}
