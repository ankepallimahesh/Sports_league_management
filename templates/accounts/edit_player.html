{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% block content %}

<style>
	.edit-wrap{max-width:920px;margin:20px auto;padding:14px}
	.card{background:var(--card);border-radius:12px;padding:18px;box-shadow:var(--shadow-sm)}
	.form-grid{display:grid;grid-template-columns:1fr 300px;gap:18px}
	@media(max-width:820px){.form-grid{grid-template-columns:1fr}}
	.avatar{display:flex;flex-direction:column;align-items:center;gap:12px}
	.avatar img{width:160px;height:160px;border-radius:12px;object-fit:cover}
	.field{display:flex;flex-direction:column;margin-bottom:12px}
	.field label{font-weight:700;margin-bottom:6px}
	.field input,.field select,.field textarea{padding:10px;border:1px solid #e6e7eb;border-radius:8px}
	.muted{color:var(--muted)}
	.actions{display:flex;gap:10px;align-items:center;margin-top:12px}
	.btn{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#fff;padding:10px 14px;border-radius:10px;border:none;cursor:pointer}
	/* Use consistent ghost button styling (matches page) so header actions look the same across pages */
	.btn.ghost{background:transparent;color:var(--muted);border:1px solid rgba(15,23,42,0.06)}
</style>

<div class="edit-wrap">
	<div class="card">
		<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
			<h2 style="margin:0">Edit profile</h2>
			<div class="muted">Update your public player information</div>
		</div>

		<form method="post" enctype="multipart/form-data" novalidate>
			{% csrf_token %}
			<div class="form-grid">
				<div>
					{% if form.non_field_errors %}
						<div class="errorlist">{{ form.non_field_errors }}</div>
					{% endif %}

					{% for field in form.visible_fields %}
						<div class="field">
							{{ field.label_tag }}
							{{ field }}
							{% if field.help_text %}
								<small class="muted">{{ field.help_text }}</small>
							{% endif %}
							{% if field.errors %}
								<div class="errorlist">{{ field.errors }}</div>
							{% endif %}
						</div>
					{% endfor %}

					<div class="actions">
						<button class="btn" type="submit">Save changes</button>
						{% if request.user.is_authenticated and request.user.player %}
							<a class="btn ghost" href="{% url 'accounts:player_profile' request.user.player.pk %}">Cancel</a>
						{% else %}
							<a class="btn ghost" href="{% url 'accounts:dashboard' %}">Cancel</a>
						{% endif %}
					</div>
				</div>

				<aside>
					<div class="avatar">
						{% if request.user.player.photo %}
							<img src="{{ request.user.player.photo.url }}" alt="{{ request.user.player.full_name }}">
						{% else %}
							<div style="width:160px;height:160px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;font-size:48px">{{ request.user.player.full_name|default:request.user.username|slice:":1" }}</div>
						{% endif %}
						<div class="muted" style="text-align:center">Avatar preview. Upload a square photo for best results.</div>
						<div style="width:100%">
							<div class="muted" style="font-size:13px;font-weight:700;margin-bottom:6px">About</div>
							<p class="muted" style="margin:0">Keep your profile concise. Visible on public player pages.</p>
						</div>
					</div>
				</aside>
			</div>
		</form>
	</div>
</div>

{% endblock %}
