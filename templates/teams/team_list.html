{% extends 'base.html' %}
{% block content %}
<style>
  .teams-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:20px;margin-top:22px}
  .team-card{background:var(--card);border-radius:16px;padding:18px;box-shadow:var(--shadow-sm);display:flex;flex-direction:column;gap:12px;align-items:stretch;transition:transform .16s ease,box-shadow .16s ease}
  .team-card:focus-within,.team-card:hover{transform:translateY(-6px);box-shadow:0 18px 46px rgba(12,24,50,0.12)}
  .team-head{display:flex;gap:14px;align-items:center;width:100%}
  .team-logo{width:68px;height:68px;border-radius:12px;object-fit:cover;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:inline-flex;align-items:center;justify-content:center;color:#fff;font-weight:800;font-size:20px}
  .team-name{font-weight:800;font-size:1.08rem;margin-bottom:4px}
  .team-meta{color:var(--muted);font-size:0.92rem}
  .team-actions{margin-left:auto;display:flex;gap:8px;align-items:center}
  .manager-badge{background:#eef2ff;color:#1e3a8a;padding:6px 10px;border-radius:999px;font-size:12px;font-weight:700}
  .players-count{color:var(--muted);font-size:13px}
  .empty-state{padding:30px;text-align:center;color:var(--muted)}

  /* Buttons */
  .btn{display:inline-block;padding:8px 14px;border-radius:10px;background:var(--accent);color:#fff;text-decoration:none;font-weight:700;border:none;cursor:pointer}
  .btn.ghost{background:transparent;color:var(--muted);border:1px solid rgba(15,23,42,0.06)}
  /* Ensure header (Dashboard / Logout) ghost buttons are visible and black */
  .topbar .btn.ghost, .topbar button.btn.ghost{background:transparent;color:#000;border:1px solid #000}
  a.btn, button.btn{transition:all .12s ease}
  a.btn:focus, button.btn:focus, a.btn:focus-visible, button.btn:focus-visible{outline:3px solid rgba(43,109,246,0.16);outline-offset:3px}

  .muted{color:var(--muted)}

  @media (max-width:720px){
    .team-head{align-items:flex-start}
    .team-actions{margin-left:0;margin-top:8px}
  }
</style>

<div class="container">
  <header style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px;flex-wrap:wrap">
    <div>
      <h2 style="margin:0">All Teams</h2>
      <div class="muted">Discover teams, view rosters and manage your teams (managers only).</div>
    </div>
    <div style="display:flex;gap:10px;align-items:center">
      <a class="btn" href="{% url 'accounts:team_register' %}" aria-label="Create or register a team">+ New Team</a>
      <a class="btn ghost" href="{% url 'accounts:dashboard' %}">Dashboard</a>
    </div>
  </header>

  {% if teams %}
    <section class="teams-grid" aria-live="polite">
      {% for t in teams %}
        <article class="team-card" role="article" aria-labelledby="team-{{ t.pk }}-name" tabindex="0">
          <div class="team-head">
            {% if t.logo %}
              <img src="{{ t.logo.url }}" alt="{{ t.name }} logo" class="team-logo">
            {% else %}
              <div class="team-logo" aria-hidden="true">{{ t.name|slice:":1" }}</div>
            {% endif %}

            <div style="min-width:0">
              <div id="team-{{ t.pk }}-name" class="team-name"><a href="{% url 'accounts:team_detail' t.pk %}">{{ t.name }}</a></div>
              <div class="team-meta">{{ t.short_name|default:"â€”" }}</div>
              <div class="players-count">{{ t.players.count }} player{{ t.players.count|pluralize }}</div>
            </div>

            <div class="team-actions">
              {% if t.user_is_member %}
                <span class="manager-badge" aria-hidden="true">Manager</span>
                <a class="btn ghost" href="{% url 'accounts:team_edit' t.pk %}" aria-label="Edit {{ t.name }}">Edit</a>
                <a class="btn ghost" href="{% url 'accounts:team_detail' t.pk %}">View</a>
              {% else %}
                <a class="btn ghost" href="{% url 'accounts:team_detail' t.pk %}">View</a>
              {% endif %}
            </div>
          </div>
        </article>
      {% endfor %}
    </section>
  {% else %}
    <div class="card empty-state">
      <h3 style="margin-top:0">No teams yet</h3>
      <p class="muted">Be the first to create a team and invite players.</p>
      <div style="margin-top:10px"><a class="btn" href="{% url 'accounts:team_register' %}">Create a team</a></div>
    </div>
  {% endif %}
</div>

{% endblock %}
